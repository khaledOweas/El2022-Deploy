"use strict";(self.webpackChunkEKOWebUI=self.webpackChunkEKOWebUI||[]).push([[489],{489:(N,m,o)=>{o.r(m),o.d(m,{AccountantModule:()=>I});var h=o(6895),y=o(7799),C=o(9345),p=o(805),g=o(4325),P=o(1462),d=o(5153),c=o(2327),u=o(3147),S=o(5226),f=o.n(S),t=o(4650),B=o(1843),T=o(4380),l=o(4006),A=o(2453),v=o(2210);function F(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.PaymentAction())}),t._uU(1," \u062d\u0641\u0638 "),t._UZ(2,"i",21),t.qZA()}}function b(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.PaymentAction())}),t._uU(1," \u062a\u062d\u062f\u064a\u062b "),t._UZ(2,"i",21),t.qZA()}}const D=[{path:"",redirectTo:"AccountantPayments",pathMatch:"full"},{path:"AccountantPayments",canActivate:[C.o],component:(()=>{class a{constructor(e,n,s,r){this.service=e,this.cdRef=n,this.dialogService=s,this.messageService=r,this.SaveMode="save",this.contentFirstBtnForFirstButton='<i class="pi pi-trash text-white"></i>',this.classForFirstButtonForFirstButton=" bg-danger text-white",this.contentSecondBtnForFirstButton='<i class="pi pi-file-edit text-white"></i>',this.classForSecondButtonForSecondButton=" bg-primary text-white",this.PaymentCategories=[],this.Cols=P.i0}ngOnInit(){this.LoadAllPaymentToday(),this.LoadAllPaymentCategory()}LoadAllPaymentToday(){let e=new d.eU;e.branchId=(new u.lX).GetUserAppSettings().CurrentBranchId,e.dateFrom=c.s.DateFrom(new Date),e.dateTo=c.s.DateTo(new Date),this.service.getPaymentsDetails(e).subscribe({next:n=>{this.Data=n,this.Clear(),this.cdRef.detectChanges()},error:n=>{}})}Search(e){let n=new d.eU;n.branchId=e.SelectedBranch.id,n.dateFrom=e.DateFrom,n.dateTo=e.DateTo,this.service.getPaymentsDetails(n).subscribe({next:s=>{this.Data=s,this.cdRef.detectChanges()},error:s=>{}})}LoadAllPaymentCategory(){this.service.getAllPaymentCategory().subscribe({next:e=>{this.PaymentCategories=e,this.cdRef.detectChanges()},error:()=>{}})}editPayment(e){console.log(e),this.Amount=e.tHEVALUE,this.AmountDetails=e.cOMMENT,this.SelectedPaymentCategory=this.PaymentCategories.find(n=>n.paymentCategoryName==e.paymentCategoryName),this.selectedPaymentToEdit=e,this.SaveMode="update"}deletePayment(e){f().fire({title:" \u0647\u0644 \u0627\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0627\u0644\u0642\u064a\u0645\u0629 \u061f ",html:`\u0645\u0635\u0631\u0648\u0641 \u0628\u064a\u0642\u064a\u0645\u0629 ${e.tHEVALUE} \u062c\u0646\u064a\u0629 \u0628\u062a\u0639\u0644\u064a\u0642 / ${e.cOMMENT}`,showDenyButton:!0,confirmButtonText:"\u0646\u0639\u0645",denyButtonText:"\u0644\u0627"}).then(n=>{if(n.isConfirmed){let s=new d.Pr;s.paymentId=e.dOCID,this.service.deletePayment(s).subscribe({next:r=>{1==r&&(this.messageService.add({severity:"success",summary:"\u0639\u0645\u0644\u064a\u0629 \u0646\u0627\u062c\u062d\u0629",detail:"\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0646\u062c\u0627\u062d"}),this.LoadAllPaymentToday(),this.cdRef.detectChanges())},error:()=>{this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062d\u0630\u0641 \u0627\u0644\u0642\u064a\u0645\u0629"})}})}else n.isDenied&&f().fire("\u062a\u0645 \u0627\u0644\u063a\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064a\u0629","","info")})}PaymentAction(){null!=this.SelectedPaymentCategory?0!=this.Amount?0!=this.AmountDetails.length?"save"==this.SaveMode?this.AddPayment():"update"==this.SaveMode&&this.UpdatePayment():this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u064a\u062c\u0628 \u0627\u062f\u062e\u0627\u0644 \u062a\u0641\u0627\u0635\u064a\u0644 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0634\u0643\u0644 \u0635\u062d\u064a\u062d"}):this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u064a\u062c\u0628 \u0627\u062f\u062e\u0627\u0644 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0634\u0643\u0644 \u0635\u062d\u064a\u062d"}):this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u064a\u062c\u0628 \u0627\u062e\u062a\u064a\u0627\u0631 \u0627\u0644\u0642\u0633\u0645"})}AddPayment(){let e=new d.Tn;e.clientDateTime=c.s.Now(),e.drawerId=(new u.lX).GetUserAppSettings().CurrentDrawerId,e.branchId=(new u.lX).GetUserAppSettings().CurrentBranchId,e.paymentCategoryID=this.SelectedPaymentCategory.iD,e.value=this.Amount,e.paymentComment=this.AmountDetails,this.service.addNewPayment(e).subscribe({next:n=>{1==n&&(this.messageService.add({severity:"success",summary:"\u0639\u0645\u0644\u064a\u0629 \u0646\u0627\u062c\u062d\u0629",detail:"\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0646\u062c\u0627\u062d"}),this.LoadAllPaymentToday(),this.cdRef.detectChanges())},error:()=>{this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0642\u064a\u0645\u0629"})}})}UpdatePayment(){let e=new d.lG;e.clientDateTime=new Date,e.drawerId=0,e.branchId=0,e.paymentCategoryID=this.SelectedPaymentCategory.iD,e.value=this.Amount,e.paymentComment=this.AmountDetails,e.paymentId=this.selectedPaymentToEdit.dOCID,this.service.updatePayment(e).subscribe({next:n=>{1==n&&(this.messageService.add({severity:"success",summary:"\u0639\u0645\u0644\u064a\u0629 \u0646\u0627\u062c\u062d\u0629",detail:"\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0646\u062c\u0627\u062d"}),this.LoadAllPaymentToday(),this.cdRef.detectChanges())},error:()=>{this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0642\u064a\u0645\u0629"})}})}Clear(){this.Amount=0,this.AmountDetails="",this.SelectedPaymentCategory=null,this.SaveMode="save"}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.KU),t.Y36(t.sBO),t.Y36(g.xA),t.Y36(p.ez))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-accountant-payments"]],features:[t._Bn([p.ez,g.xA])],decls:34,vars:22,consts:[["position","top-left",3,"showTransformOptions"],[1,"card","card-flush","shadow-sm"],[1,"card-header"],["translate","MENU.ExpensesAmount",1,"card-title"],[1,"card-toolbar"],[1,"card-body","py-5"],[3,"rangeDates","WithSinglBranch","onSearchSubmit"],[1,"row"],[1,"col-md-4"],[1,"d-flex","flex-column","mb-8","fv-row"],[1,"d-flex","align-items-center","fs-6","fw-bold","mb-2"],[1,""],["styleClass"," taj-font fc-primng","placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u0642\u0633\u0645","filterBy","paymentCategoryName","optionLabel","paymentCategoryName",3,"options","filter","ngModel","ngModelChange"],["type","text","placeholder","\u0627\u062f\u062e\u0644 \u0627\u0644\u0645\u0628\u0644\u063a",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0640\u0644",1,"form-control",3,"ngModel","ngModelChange"],[1,"row",2,"display","flex","justify-content","center"],[1,"col-md-5",2,"display","flex","justify-content","center"],["class","btn btn-light-success","style","margin-top: 30px;direction: ltr;width: 35%;",3,"click",4,"ngIf"],["class","btn btn-light-primary","style","margin-top: 30px;direction: ltr;width: 35%;",3,"click",4,"ngIf"],[3,"cols","rowsPageNumbers","SecondBtn","contentSecondBtn","classSecondBtn","FirstBtn","contentFirstBtn","classFirstBtn","data","chooseColomns","pagination","scrollable","secondButtonEvent","firstButtonEvent"],[1,"btn","btn-light-success",2,"margin-top","30px","direction","ltr","width","35%",3,"click"],[1,"fa-solid","fa-floppy-disk"],[1,"btn","btn-light-primary",2,"margin-top","30px","direction","ltr","width","35%",3,"click"]],template:function(e,n){1&e&&(t._UZ(0,"p-toast",0),t.TgZ(1,"div",1)(2,"div",2),t._UZ(3,"h3",3)(4,"div",4),t.qZA(),t.TgZ(5,"div",5)(6,"app-searchcriteria",6),t.NdJ("onSearchSubmit",function(r){return n.Search(r)}),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"div",7)(9,"div",8)(10,"div",9)(11,"label",10)(12,"span",11),t._uU(13,"\u0627\u0644\u0642\u0633\u0645"),t.qZA()(),t.TgZ(14,"p-dropdown",12),t.NdJ("ngModelChange",function(r){return n.SelectedPaymentCategory=r}),t.qZA()()(),t.TgZ(15,"div",8)(16,"div",9)(17,"label",10)(18,"span",11),t._uU(19,"\u0627\u0644\u0645\u0628\u0644\u063a"),t.qZA()(),t.TgZ(20,"input",13),t.NdJ("ngModelChange",function(r){return n.Amount=r}),t.qZA()()(),t.TgZ(21,"div",8)(22,"div",9)(23,"label",10)(24,"span",11),t._uU(25,"\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644"),t.qZA()(),t.TgZ(26,"input",14),t.NdJ("ngModelChange",function(r){return n.AmountDetails=r}),t.qZA()()()(),t.TgZ(27,"div",15)(28,"div",16),t.YNc(29,F,3,0,"button",17),t.YNc(30,b,3,0,"button",18),t.qZA()(),t.TgZ(31,"div",7)(32,"div")(33,"app-shared-datatable",19),t.NdJ("secondButtonEvent",function(r){return n.editPayment(r)})("firstButtonEvent",function(r){return n.deletePayment(r)}),t.qZA()()()()()),2&e&&(t.Q6J("showTransformOptions","translateX(100%)"),t.xp6(6),t.Q6J("rangeDates",n.rangeDates)("WithSinglBranch",!0),t.xp6(8),t.Q6J("options",n.PaymentCategories)("filter",!0)("ngModel",n.SelectedPaymentCategory),t.xp6(6),t.Q6J("ngModel",n.Amount),t.xp6(6),t.Q6J("ngModel",n.AmountDetails),t.xp6(3),t.Q6J("ngIf","save"==n.SaveMode),t.xp6(1),t.Q6J("ngIf","update"==n.SaveMode),t.xp6(3),t.Q6J("cols",n.Cols)("rowsPageNumbers",25)("SecondBtn",!0)("contentSecondBtn",n.contentSecondBtnForFirstButton)("classSecondBtn",n.classForSecondButtonForSecondButton)("FirstBtn",!0)("contentFirstBtn",n.contentFirstBtnForFirstButton)("classFirstBtn",n.classForFirstButtonForFirstButton)("data",n.Data)("chooseColomns",!0)("pagination",!0)("scrollable",!1))},dependencies:[h.O5,B.G,T.d,l.Fj,l.JJ,l.On,A.FN,v.Lt]}),a})()}];let Z=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[y.Bz.forChild(D),y.Bz]}),a})();var w=o(7772),U=o(2665),E=o(6353);let I=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.ez,E.m,l.u5,Z,A.EV,v.kW,w.$,U.O]}),a})()}}]);