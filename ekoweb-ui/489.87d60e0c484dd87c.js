"use strict";(self.webpackChunkEKOWebUI=self.webpackChunkEKOWebUI||[]).push([[489],{489:(G,h,a)=>{a.r(h),a.d(h,{AccountantModule:()=>d});var p=a(6895),y=a(7799),P=a(4813),g=a(805),f=a(4325),S=a(1462),r=a(5153),B=a(5226),v=a.n(B),t=a(4650),T=a(1843),x=a(4380),b=a(5880),F=a(5519),u=a(4006),A=a(2453),C=a(2210);function D(s,e){if(1&s){const n=t.EpF();t.TgZ(0,"app-searchcriteria",21),t.NdJ("onSearchSubmit",function(o){t.CHM(n);const m=t.oxw();return t.KtG(m.Search(o))}),t.qZA()}if(2&s){const n=t.oxw();t.Q6J("rangeDates",n.rangeDates)("WithSinglBranch",!0)}}function M(s,e){if(1&s){const n=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.PaymentAction())}),t._uU(1," \u062d\u0641\u0638 "),t._UZ(2,"i",23),t.qZA()}}function Z(s,e){if(1&s){const n=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.PaymentAction())}),t._uU(1," \u062a\u062d\u062f\u064a\u062b "),t._UZ(2,"i",23),t.qZA()}}function w(s,e){if(1&s&&(t.TgZ(0,"div"),t._UZ(1,"app-shared-datatable",25),t.qZA()),2&s){const n=t.oxw();t.xp6(1),t.Q6J("cols",n.Cols)("rowsPageNumbers",25)("data",n.Data)("chooseColomns",!0)("pagination",!0)("scrollable",!1)}}function I(s,e){if(1&s){const n=t.EpF();t.TgZ(0,"div")(1,"app-shared-datatable",26),t.NdJ("secondButtonEvent",function(o){t.CHM(n);const m=t.oxw();return t.KtG(m.editPayment(o))})("firstButtonEvent",function(o){t.CHM(n);const m=t.oxw();return t.KtG(m.deletePayment(o))}),t.qZA()()}if(2&s){const n=t.oxw();t.xp6(1),t.Q6J("cols",n.Cols)("rowsPageNumbers",25)("SecondBtn",!0)("contentSecondBtn",n.contentSecondBtnForFirstButton)("classSecondBtn",n.classForSecondButtonForSecondButton)("FirstBtn",!0)("contentFirstBtn",n.contentFirstBtnForFirstButton)("classFirstBtn",n.classForFirstButtonForFirstButton)("data",n.Data)("chooseColomns",!0)("pagination",!0)("scrollable",!1)}}class l{constructor(e,n,i,o){this.service=e,this.cdRef=n,this.dialogService=i,this.messageService=o,this.SaveMode="save",this.contentFirstBtnForFirstButton='<i class="pi pi-trash text-white"></i>',this.classForFirstButtonForFirstButton=" bg-danger text-white",this.contentSecondBtnForFirstButton='<i class="pi pi-file-edit text-white"></i>',this.classForSecondButtonForSecondButton=" bg-primary text-white",this.PaymentCategories=[],this.Cols=S.i0}ngOnInit(){this.LoadAllPaymentToday(),this.LoadAllPaymentCategory()}LoadAllPaymentToday(){let e=new r.eU;e.branchId=1;let n=new Date;n.setDate((new Date).getDate()-4),n.setHours(0,0,0,0);let i=new Date;i.setHours(23,59,59,999),e.dateFrom=n,e.dateTo=i,this.service.getPaymentsDetails(e).subscribe({next:o=>{this.Data=o,this.Clear(),this.cdRef.detectChanges()},error:o=>{}})}Search(e){let n=new r.eU;n.branchId=e.SelectedBranch.id,n.dateFrom=e.DateFrom,n.dateTo=e.DateTo,this.service.getPaymentsDetails(n).subscribe({next:i=>{this.Data=i,this.cdRef.detectChanges()},error:i=>{}})}LoadAllPaymentCategory(){this.service.getAllPaymentCategory().subscribe({next:e=>{this.PaymentCategories=e,this.cdRef.detectChanges()},error:()=>{}})}editPayment(e){console.log(e),this.Amount=e.tHEVALUE,this.AmountDetails=e.cOMMENT,this.SelectedPaymentCategory=this.PaymentCategories.find(n=>n.paymentCategoryName==e.paymentCategoryName),this.selectedPaymentToEdit=e,this.SaveMode="update"}deletePayment(e){v().fire({title:" \u0647\u0644 \u0627\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0627\u0644\u0642\u064a\u0645\u0629 \u061f ",html:`\u0645\u0635\u0631\u0648\u0641 \u0628\u064a\u0642\u064a\u0645\u0629 ${e.tHEVALUE} \u062c\u0646\u064a\u0629 \u0628\u062a\u0639\u0644\u064a\u0642 / ${e.cOMMENT}`,showDenyButton:!0,confirmButtonText:"\u0646\u0639\u0645",denyButtonText:"\u0644\u0627"}).then(n=>{if(n.isConfirmed){let i=new r.Pr;i.paymentId=e.dOCID,this.service.deletePayment(i).subscribe({next:o=>{1==o&&(this.messageService.add({severity:"success",summary:"\u0639\u0645\u0644\u064a\u0629 \u0646\u0627\u062c\u062d\u0629",detail:"\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0646\u062c\u0627\u062d"}),this.LoadAllPaymentToday(),this.cdRef.detectChanges())},error:()=>{this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062d\u0630\u0641 \u0627\u0644\u0642\u064a\u0645\u0629"})}})}else n.isDenied&&v().fire("\u062a\u0645 \u0627\u0644\u063a\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064a\u0629","","info")})}PaymentAction(){null!=this.SelectedPaymentCategory?0!=this.Amount?0!=this.AmountDetails.length?"save"==this.SaveMode?this.AddPayment():"update"==this.SaveMode&&this.UpdatePayment():this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u064a\u062c\u0628 \u0627\u062f\u062e\u0627\u0644 \u062a\u0641\u0627\u0635\u064a\u0644 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0634\u0643\u0644 \u0635\u062d\u064a\u062d"}):this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u064a\u062c\u0628 \u0627\u062f\u062e\u0627\u0644 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0634\u0643\u0644 \u0635\u062d\u064a\u062d"}):this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u064a\u062c\u0628 \u0627\u062e\u062a\u064a\u0627\u0631 \u0627\u0644\u0642\u0633\u0645"})}AddPayment(){let e=new r.Tn;e.clientDateTime=new Date,e.drawerId=1,e.branchId=1,e.paymentCategoryID=this.SelectedPaymentCategory.iD,e.value=this.Amount,e.paymentComment=this.AmountDetails,this.service.addNewPayment(e).subscribe({next:n=>{1==n&&(this.messageService.add({severity:"success",summary:"\u0639\u0645\u0644\u064a\u0629 \u0646\u0627\u062c\u062d\u0629",detail:"\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0646\u062c\u0627\u062d"}),this.LoadAllPaymentToday(),this.cdRef.detectChanges())},error:()=>{this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0642\u064a\u0645\u0629"})}})}UpdatePayment(){let e=new r.lG;e.clientDateTime=new Date,e.drawerId=0,e.branchId=0,e.paymentCategoryID=this.SelectedPaymentCategory.iD,e.value=this.Amount,e.paymentComment=this.AmountDetails,e.paymentId=this.selectedPaymentToEdit.dOCID,this.service.updatePayment(e).subscribe({next:n=>{1==n&&(this.messageService.add({severity:"success",summary:"\u0639\u0645\u0644\u064a\u0629 \u0646\u0627\u062c\u062d\u0629",detail:"\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0642\u064a\u0645\u0629 \u0628\u0646\u062c\u0627\u062d"}),this.LoadAllPaymentToday(),this.cdRef.detectChanges())},error:()=>{this.messageService.add({severity:"error",summary:"\u062d\u062f\u062b \u062e\u0637\u0623",detail:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0642\u064a\u0645\u0629"})}})}Clear(){this.Amount=0,this.AmountDetails="",this.SelectedPaymentCategory=null,this.SaveMode="save"}}l.\u0275fac=function(e){return new(e||l)(t.Y36(r.KU),t.Y36(t.sBO),t.Y36(f.xA),t.Y36(g.ez))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-accountant-payments"]],features:[t._Bn([g.ez,f.xA])],decls:34,vars:11,consts:[["position","top-left",3,"showTransformOptions"],[1,"card","card-flush","shadow-sm"],[1,"card-header"],["translate","MENU.ExpensesAmount",1,"card-title"],[1,"card-toolbar"],[1,"card-body","py-5"],[3,"rangeDates","WithSinglBranch","onSearchSubmit",4,"appIsGranted"],[1,"row"],[1,"col-md-4"],[1,"d-flex","flex-column","mb-8","fv-row"],[1,"d-flex","align-items-center","fs-6","fw-bold","mb-2"],[1,""],["styleClass"," taj-font fc-primng","placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u0642\u0633\u0645","filterBy","paymentCategoryName","optionLabel","paymentCategoryName",3,"options","filter","ngModel","ngModelChange"],["type","text","placeholder","\u0627\u062f\u062e\u0644 \u0627\u0644\u0645\u0628\u0644\u063a",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0640\u0644",1,"form-control",3,"ngModel","ngModelChange"],[1,"row",2,"display","flex","justify-content","center"],[1,"col-md-5",2,"display","flex","justify-content","center"],["class","btn btn-light-success","style","margin-top: 30px;direction: ltr;width: 35%;",3,"click",4,"ngIf"],["class","btn btn-light-primary","style","margin-top: 30px;direction: ltr;width: 35%;",3,"click",4,"ngIf"],[4,"appIsNotGranted"],[4,"appIsGranted"],[3,"rangeDates","WithSinglBranch","onSearchSubmit"],[1,"btn","btn-light-success",2,"margin-top","30px","direction","ltr","width","35%",3,"click"],[1,"fa-solid","fa-floppy-disk"],[1,"btn","btn-light-primary",2,"margin-top","30px","direction","ltr","width","35%",3,"click"],[3,"cols","rowsPageNumbers","data","chooseColomns","pagination","scrollable"],[3,"cols","rowsPageNumbers","SecondBtn","contentSecondBtn","classSecondBtn","FirstBtn","contentFirstBtn","classFirstBtn","data","chooseColomns","pagination","scrollable","secondButtonEvent","firstButtonEvent"]],template:function(e,n){1&e&&(t._UZ(0,"p-toast",0),t.TgZ(1,"div",1)(2,"div",2),t._UZ(3,"h3",3)(4,"div",4),t.qZA(),t.TgZ(5,"div",5),t.YNc(6,D,1,2,"app-searchcriteria",6),t._UZ(7,"br"),t.TgZ(8,"div",7)(9,"div",8)(10,"div",9)(11,"label",10)(12,"span",11),t._uU(13,"\u0627\u0644\u0642\u0633\u0645"),t.qZA()(),t.TgZ(14,"p-dropdown",12),t.NdJ("ngModelChange",function(o){return n.SelectedPaymentCategory=o}),t.qZA()()(),t.TgZ(15,"div",8)(16,"div",9)(17,"label",10)(18,"span",11),t._uU(19,"\u0627\u0644\u0645\u0628\u0644\u063a"),t.qZA()(),t.TgZ(20,"input",13),t.NdJ("ngModelChange",function(o){return n.Amount=o}),t.qZA()()(),t.TgZ(21,"div",8)(22,"div",9)(23,"label",10)(24,"span",11),t._uU(25,"\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644"),t.qZA()(),t.TgZ(26,"input",14),t.NdJ("ngModelChange",function(o){return n.AmountDetails=o}),t.qZA()()()(),t.TgZ(27,"div",15)(28,"div",16),t.YNc(29,M,3,0,"button",17),t.YNc(30,Z,3,0,"button",18),t.qZA()(),t.TgZ(31,"div",7),t.YNc(32,w,2,6,"div",19),t.YNc(33,I,2,12,"div",20),t.qZA()()()),2&e&&(t.Q6J("showTransformOptions","translateX(100%)"),t.xp6(6),t.Q6J("appIsGranted","SearchPaymentHistory"),t.xp6(8),t.Q6J("options",n.PaymentCategories)("filter",!0)("ngModel",n.SelectedPaymentCategory),t.xp6(6),t.Q6J("ngModel",n.Amount),t.xp6(6),t.Q6J("ngModel",n.AmountDetails),t.xp6(3),t.Q6J("ngIf","save"==n.SaveMode),t.xp6(1),t.Q6J("ngIf","update"==n.SaveMode),t.xp6(2),t.Q6J("appIsNotGranted","SearchPaymentHistory"),t.xp6(1),t.Q6J("appIsGranted","SearchPaymentHistory"))},dependencies:[p.O5,T.G,x.d,b.J,F.y,u.Fj,u.JJ,u.On,A.FN,C.Lt]});const N=[{path:"",redirectTo:"AccountantPayments",pathMatch:"full"},{path:"AccountantPayments",canActivate:[P.o],component:l}];class c{}c.\u0275fac=function(e){return new(e||c)},c.\u0275mod=t.oAB({type:c}),c.\u0275inj=t.cJS({imports:[y.Bz.forChild(N),y.Bz]});var E=a(7772),J=a(2665),U=a(3207);class d{}d.\u0275fac=function(e){return new(e||d)},d.\u0275mod=t.oAB({type:d}),d.\u0275inj=t.cJS({imports:[p.ez,U.m,u.u5,c,A.EV,C.kW,E.$,J.O]})}}]);